<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="lozen">
<title>ad - Set up continuous integration and continuous deployment for Gitlab CI/CD • lozen</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ad - Set up continuous integration and continuous deployment for Gitlab CI/CD">
<meta property="og:description" content="lozen">
<meta property="og:image" content="https://thinkr-open.github.io/lozen/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lozen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/aa-create-a-new-project-with-gitlab.html">aa - Create a new project with GitLab</a>
    <a class="dropdown-item" href="../articles/aa-launch-full-project-all-in-one.html">aa - Launch full project - all in one</a>
    <a class="dropdown-item" href="../articles/ab-create-a-new-project-with-github.html">ab - Create a new project with GitHub</a>
    <a class="dropdown-item" href="../articles/ac-create-the-skeleton-of-the-r-project--package-app-book-.html">ac - Create the skeleton of the R project (package, app, book)</a>
    <a class="dropdown-item" href="../articles/ad-set-up-continuous-integration-and-deployment-through-gitlab-ci.html">ad - Set up continuous integration and continuous deployment for Gitlab CI/CD</a>
    <a class="dropdown-item" href="../articles/ae-create-weekly-with-github-or-gitlab.html">ae - Create Weekly with GitHub or GitLab</a>
    <a class="dropdown-item" href="../articles/af-build-a-pkgdown-with-reports.html">af - Build a pkgdown with reports</a>
    <a class="dropdown-item" href="../articles/ba-manage-forge-board-wiki.html">ba - Manage forge board and wiki</a>
    <a class="dropdown-item" href="../articles/bb-manage-git-tools--branches-commits-etc--.html">bb - Manage git tools (branches, commits, etc.)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ad - Set up continuous integration and continuous deployment for Gitlab CI/CD</h1>
            
      
      
      <div class="d-none name"><code>ad-set-up-continuous-integration-and-deployment-through-gitlab-ci.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lozen</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="initiate-the-continuous-integration-ci-continuous-deployment-cd">Initiate the Continuous Integration (CI) / Continuous Deployment
(CD)<a class="anchor" aria-label="anchor" href="#initiate-the-continuous-integration-ci-continuous-deployment-cd"></a>
</h2>
<p>These operations will set up on Gitlab : - the continuous integration
of your project - the continuous deployment, on Gitlab Pages, of your
pkgdown (if you are working with a R package or a golem app) or of your
bookdown.</p>
<p>A <code>.gitlab-ci.yml</code> file will be created at the root of
your project. Please ensure that this file will be pushed on your
repository for the CI/CD to be working.</p>
<p>Please note that any <code>.gitlab-ci.yml</code> file already present
would be overwritten.</p>
<div class="section level3">
<h3 id="for-a-r-package-or-a-golem-app">For a R package or a {golem} app<a class="anchor" aria-label="anchor" href="#for-a-r-package-or-a-golem-app"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lozen</span><span class="fu">::</span><span class="fu"><a href="../reference/use_gitlab_ci.html">use_gitlab_ci</a></span><span class="op">(</span></span>
<span>  project_path <span class="op">=</span> <span class="va">project_path</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"check-coverage-pkgdown"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Please note that the <code>R/</code> and <code>tests/</code> folders
will be missing from a R package created using
<code>create_r_project(type = "package")</code>. If these folders
remains missing, the “coverage” job of the “test” stage of the CI
pipeline will fail (the following steps of the CI pipeline will
nevertheless be run).</p>
</div>
<div class="section level3">
<h3 id="for-a-book">For a book<a class="anchor" aria-label="anchor" href="#for-a-book"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lozen</span><span class="fu">::</span><span class="fu"><a href="../reference/use_gitlab_ci.html">use_gitlab_ci</a></span><span class="op">(</span></span>
<span>  project_path <span class="op">=</span> <span class="va">project_path</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"bookdown"</span>,</span>
<span>  bookdown_output_format <span class="op">=</span> <span class="st">"lozen::paged_template"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># OR</span></span>
<span></span>
<span><span class="fu">lozen</span><span class="fu">::</span><span class="fu"><a href="../reference/use_gitlab_ci.html">use_gitlab_ci</a></span><span class="op">(</span></span>
<span>  project_path <span class="op">=</span> <span class="va">project_path</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"bookdown"</span>,</span>
<span>  bookdown_output_format <span class="op">=</span> <span class="st">"lozen::bs4_book_template"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Two options are allowed for the parameter
<code>bookdown_output_format</code>: “lozen::paged_template” or
“lozen::bs4_book_template”. The former will render the book using
<code><a href="https://rdrr.io/pkg/pagedown/man/html_paged.html" class="external-link">pagedown::html_paged</a></code> while the latter will use
<code><a href="https://pkgs.rstudio.com/bookdown/reference/bs4_book.html" class="external-link">bookdown::bs4_book</a></code>.</p>
</div>
<div class="section level3">
<h3 id="how-can-i-find-the-pkgdownbook-associated-with-my-project">How can I find the pkgdown/book associated with my project<a class="anchor" aria-label="anchor" href="#how-can-i-find-the-pkgdownbook-associated-with-my-project"></a>
</h3>
<p>By default, a book project created using
<code>lozen::create_r_project(type = "book")</code> does not contain a
<code>.Rproj</code> file, standing for a RStudio project. If this file
is missing the “Git” panel won’t be visible in RStudio.</p>
<p>If you wish to display this panel, you must create a RStudio project
within the directory in which your book files are located. Please do the
following : - Click on the “File” tab - New project - Existing directory
- Select the directory of your book</p>
<p>The other option is to use the Terminal to use the Git command line
interface.</p>
<p>Once the former steps are done, you can commit all your changes and
push them to your repository remote.</p>
<p>Thereafter, you should be able to <a href="https://docs.gitlab.com/ee/ci/pipelines/#view-pipelines" class="external-link">see your
pipeline running</a> on Gitlab.</p>
<p>If your pipeline did not raise any error, the deployed pkgdown/book
is now hosted on <a href="https://docs.gitlab.com/ee/user/project/pages/getting_started_part_one.html" class="external-link">Gitlab
pages</a>.</p>
<p>If you are working on <code>https://gitlab.com</code>, the url should
be <code>https://username.gitlab.io/your.repository.name</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="continuous-deployment-on-posit-connect">Continuous deployment on Posit Connect<a class="anchor" aria-label="anchor" href="#continuous-deployment-on-posit-connect"></a>
</h2>
<div class="section level3">
<h3 id="cd-of-a-pkgdown">CD of a pkgdown<a class="anchor" aria-label="anchor" href="#cd-of-a-pkgdown"></a>
</h3>
<p>For the following to be working, please ensure you are working in a
valid R package. Your project must be associated with a repository
present on Gitlab.</p>
<p>If this is not done yet please go to the vignette
<code>vignettes/aa-create-a-new-project-with-gitlab.Rmd</code> and
follow the steps related to the creation of a project on Gitlab and of a
R package skeleton.</p>
<p>Before running the following commands please ensure that you are
working directory is that of your R package project.</p>
<div class="section level4">
<h4 id="create-the-pkgdown">Create the pkgdown<a class="anchor" aria-label="anchor" href="#create-the-pkgdown"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_pkgdown.html" class="external-link">use_pkgdown</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">build_site</a></span><span class="op">(</span>override <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>destination <span class="op">=</span> <span class="st">"inst/site"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="initiate-the-deployment-of-your-pkgdown">Initiate the deployment of your pkgdown<a class="anchor" aria-label="anchor" href="#initiate-the-deployment-of-your-pkgdown"></a>
</h4>
<div class="section level5">
<h5 id="to-be-done-on-your-r-project">To be done on your R project<a class="anchor" aria-label="anchor" href="#to-be-done-on-your-r-project"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lozen</span><span class="fu">::</span><span class="fu"><a href="../reference/use_gitlab_ci_deploy_connect.html">use_gitlab_ci_deploy_connect_pkgdown</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Any <code>.gitlab-ci.yml</code> file already present in your project
is now completed with new staged, specific to the deployment on
Connect.</p>
<p>Be aware that running this command multiple times would duplicate
these steps in your <code>.gitlab-ci.yml</code> file. It should be
avoided.</p>
</div>
<div class="section level5">
<h5 id="to-be-done-on-gitlab">To be done on Gitlab<a class="anchor" aria-label="anchor" href="#to-be-done-on-gitlab"></a>
</h5>
<p>Some environment variables must be set on Gitlab for the CI/CD to be
working.</p>
<p>You’ll need to define :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CONNECT_URL</span> <span class="op">&lt;-</span> <span class="st">"https://my.connect.url"</span></span>
<span><span class="va">CONNECT_NAME</span> <span class="op">&lt;-</span> <span class="st">"my.connect.server.name"</span></span>
<span><span class="va">CONNECT_USER</span> <span class="op">&lt;-</span> <span class="st">"my.connect.username"</span></span>
<span><span class="va">CONNECT_TOKEN</span> <span class="op">&lt;-</span> <span class="st">"my.api.key.generated.in.connect"</span></span>
<span><span class="va">APP_NAME</span> <span class="op">&lt;-</span> <span class="st">"the.name.of.your.pkgdown.on.connect"</span></span>
<span><span class="co"># APP_NAME is not mandatory; whether it is not provided, it will be replaced by the name of your project on Gitlab</span></span></code></pre></div>
<p>For most of them, you may have already set them on your
<code>.Renviron</code> file (see the dedicated section on the {lozen}
README).</p>
<p>If you are not familiar with defining environement variable on
gitlab, please follow the <a href="https://docs.gitlab.com/ee/ci/variables/index.html" class="external-link">official
documentation</a>.</p>
<p>Once this is done, you can commit all your changes and push them to
your repository remote.</p>
<p>Thereafter, you should be able to <a href="https://docs.gitlab.com/ee/ci/pipelines/#view-pipelines" class="external-link">see your
pipeline running</a> on Gitlab.</p>
</div>
<div class="section level5">
<h5 id="how-can-i-find-the-pkgdown-associated-with-my-r-package-on-posit-connect">How can I find the pkgdown associated with my R package on Posit
Connect<a class="anchor" aria-label="anchor" href="#how-can-i-find-the-pkgdown-associated-with-my-r-package-on-posit-connect"></a>
</h5>
<p>If your pipeline did not raise any error, you app is now deployed on
your Posit Connect. You can now log in your Posit Connect and enjoy your
pkgdown !</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="cd-of-a-golem-shiny-app">CD of a golem shiny app<a class="anchor" aria-label="anchor" href="#cd-of-a-golem-shiny-app"></a>
</h3>
<p>For the following to be working, please ensure you are working in a
shiny app initiated with {golem}. Your app project must be associated
with a repository present on Gitlab.</p>
<p>If this is not done yet please go to the vignette
<code>vignettes/aa-create-a-new-project-with-gitlab.Rmd</code> and
follow the steps related to the creation of a project on Gitlab and of a
shiny app skeleton.</p>
<p>Before running the following commands please ensure that you are
working directory is that of your golem project.</p>
<div class="section level4">
<h4 id="add-an-app-r-at-the-root-of-your-package-to-deploy-on-rstudio-connect">Add an app.R at the root of your package to deploy on RStudio
Connect<a class="anchor" aria-label="anchor" href="#add-an-app-r-at-the-root-of-your-package-to-deploy-on-rstudio-connect"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">golem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/golem/man/rstudio_deploy.html" class="external-link">add_rstudioconnect_file</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="initiate-the-deployment-of-your-app">Initiate the deployment of your app<a class="anchor" aria-label="anchor" href="#initiate-the-deployment-of-your-app"></a>
</h4>
<div class="section level5">
<h5 id="to-be-done-on-your-r-project-1">To be done on your R project<a class="anchor" aria-label="anchor" href="#to-be-done-on-your-r-project-1"></a>
</h5>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/use_gitlab_ci_deploy_connect.html">use_gitlab_ci_deploy_connect_shiny</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Any <code>.gitlab-ci.yml</code> file already present in your project
is now completed with new staged, specific to the deployment on
Connect.</p>
<p>Be aware that running this command multiple times would duplicate
these steps in your <code>.gitlab-ci.yml</code> file. It should be
avoided.</p>
</div>
<div class="section level5">
<h5 id="to-be-done-on-gitlab-1">To be done on Gitlab<a class="anchor" aria-label="anchor" href="#to-be-done-on-gitlab-1"></a>
</h5>
<p>Some environment variables must be set on Gitlab for the CI/CD to be
working.</p>
<p>You’ll need to define :</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CONNECT_URL</span> <span class="op">&lt;-</span> <span class="st">"https://my.connect.url"</span></span>
<span><span class="va">CONNECT_NAME</span> <span class="op">&lt;-</span> <span class="st">"my.connect.server.name"</span></span>
<span><span class="va">CONNECT_USER</span> <span class="op">&lt;-</span> <span class="st">"my.connect.username"</span></span>
<span><span class="va">CONNECT_TOKEN</span> <span class="op">&lt;-</span> <span class="st">"my.api.key.generated.in.connect"</span></span>
<span><span class="va">APP_NAME</span> <span class="op">&lt;-</span> <span class="st">"the.name.of.your.app.on.connect"</span></span>
<span><span class="co"># APP_NAME is not mandatory; whether it is not provided, it will be replaced by the name of your project on Gitlab</span></span></code></pre></div>
<p>For most of them, you may have already set them on your
<code>.Renviron</code> file (see the dedicated section on the {lozen}
README).</p>
<p>If you are not familiar with defining environement variable on
gitlab, please follow the <a href="https://docs.gitlab.com/ee/ci/variables/index.html" class="external-link">official
documentation</a>.</p>
<p>Once this is done, you can commit all your changes and push them to
your repository remote.</p>
<p>Thereafter, you should be able to <a href="https://docs.gitlab.com/ee/ci/pipelines/#view-pipelines" class="external-link">see your
pipeline running</a> on Gitlab.</p>
</div>
<div class="section level5">
<h5 id="how-can-i-find-the-app-associated-with-my-golem-package">How can I find the app associated with my {golem} package<a class="anchor" aria-label="anchor" href="#how-can-i-find-the-app-associated-with-my-golem-package"></a>
</h5>
<p>If your pipeline did not raise any error, you app is now deployed on
your Posit Connect. You can now log in your Posit Connect and enjoy your
app !</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="cd-of-a-book">CD of a book<a class="anchor" aria-label="anchor" href="#cd-of-a-book"></a>
</h3>
<p>For the following to be working, please ensure you are working in a
book project. Your app project must be associated with a repository
present on Gitlab.</p>
<p>If this is not done yet please go to the vignette
<code>vignettes/aa-create-a-new-project-with-gitlab.Rmd</code> and
follow the steps related to the creation of a project on Gitlab and of a
book project skeleton.</p>
<p>Before running the following commands please ensure that you are
working directory is that of your book project. If no .RProj exists in
the directory in which your book files and folders are stored, you can
use <code>setwd("path/of/your/book")</code>.</p>
<div class="section level4">
<h4 id="build-your-book">Build your book<a class="anchor" aria-label="anchor" href="#build-your-book"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lozen</span><span class="fu">::</span><span class="fu"><a href="../reference/render_book.html">render_book</a></span><span class="op">(</span><span class="st">"index.Rmd"</span>, output_format <span class="op">=</span> <span class="st">"lozen::paged_template"</span><span class="op">)</span></span>
<span><span class="co"># OR</span></span>
<span><span class="fu">lozen</span><span class="fu">::</span><span class="fu"><a href="../reference/render_book.html">render_book</a></span><span class="op">(</span><span class="st">"index.Rmd"</span>, output_format <span class="op">=</span> <span class="st">"lozen::bs4_book_template"</span><span class="op">)</span></span></code></pre></div>
<p>Two options are allowed for the parameter <code>output_format</code>:
“lozen::paged_template” or “lozen::bs4_book_template”. The former will
render the book using <code><a href="https://rdrr.io/pkg/pagedown/man/html_paged.html" class="external-link">pagedown::html_paged</a></code> while the latter
will use <code><a href="https://pkgs.rstudio.com/bookdown/reference/bs4_book.html" class="external-link">bookdown::bs4_book</a></code>.</p>
</div>
<div class="section level4">
<h4 id="initiate-the-deployment-of-your-book">Initiate the deployment of your book<a class="anchor" aria-label="anchor" href="#initiate-the-deployment-of-your-book"></a>
</h4>
<div class="section level5">
<h5 id="to-be-done-on-your-r-project-2">To be done on your R project<a class="anchor" aria-label="anchor" href="#to-be-done-on-your-r-project-2"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lozen</span><span class="fu">::</span><span class="fu"><a href="../reference/use_gitlab_ci_deploy_connect.html">use_gitlab_ci_deploy_connect_bookdown</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Any <code>.gitlab-ci.yml</code> file already present in your project
is now completed with new staged, specific to the deployment on
Connect.</p>
<p>Be aware that running this command multiple times would duplicate
these steps in your <code>.gitlab-ci.yml</code> file. It should be
avoided.</p>
<p><strong>Important</strong>: be sure that the <code>_book</code>
directory is not listed in your <code>.gitignore</code> file !</p>
<p><em>note</em>: if you wish to compile the html files in odt files
please add the following to the produced <code>.gitlab-ci.yml</code>
file :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> Rscript -e 'bookdown::render_book("index.Rmd", output_format = "lozen::paged_template", clean = FALSE);file.copy("_main.html", "public/index.html")'</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> Rscript -e 'lozen::html_to_odt(input_html = "public/index.html", output_odt = "public/rapport.odt")'</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> Rscript -e 'toutes_fiches &lt;- list.files(pattern = "[.]Rmd");lozen:::compile_fiches(fiches = toutes_fiches, outdir = "public", type = c("html", "odt"), open=FALSE)'</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> Rscript -e 'utils::zip(files = list.files("public", pattern = "[.]odt", full.names = TRUE ), zipfile = file.path("public", "odt_files.zip"))'</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> mv _main.knit.md public/_main.knit.md</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="to-be-done-on-gitlab-2">To be done on Gitlab<a class="anchor" aria-label="anchor" href="#to-be-done-on-gitlab-2"></a>
</h5>
<p>Some environment variables must be set on Gitlab for the CI/CD to be
working.</p>
<p>You’ll need to define :</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CONNECT_URL</span> <span class="op">&lt;-</span> <span class="st">"https://my.connect.url"</span></span>
<span><span class="va">CONNECT_NAME</span> <span class="op">&lt;-</span> <span class="st">"my.connect.server.name"</span></span>
<span><span class="va">CONNECT_USER</span> <span class="op">&lt;-</span> <span class="st">"my.connect.username"</span></span>
<span><span class="va">CONNECT_TOKEN</span> <span class="op">&lt;-</span> <span class="st">"my.api.key.generated.in.connect"</span></span>
<span><span class="va">APP_NAME</span> <span class="op">&lt;-</span> <span class="st">"the.name.of.your.book.on.connect"</span></span>
<span><span class="co"># APP_NAME is not mandatory; whether it is not provided, it will be replaced by the name of your project on Gitlab</span></span></code></pre></div>
<p>For most of them, you may have already set them on your
<code>.Renviron</code> file (see the dedicated section on the {lozen}
README).</p>
<p>If you are not familiar with defining environement variable on
gitlab, please follow the <a href="https://docs.gitlab.com/ee/ci/variables/index.html" class="external-link">official
documentation</a>.</p>
<p>By default, a book project created using
<code>lozen::create_r_project(type = "book")</code> does not contain a
<code>.Rproj</code> file, standing for a RStudio project. If this file
is missing the “Git” panel won’t be visible in RStudio.</p>
<p>If you wish to display this panel, you must create a RStudio project
within the directory in which your book files are located. Please do the
following : - Click on the “File” tab - New project - Existing directory
- Select the directory of your book</p>
<p>The other option is to use the Terminal to use the Git command line
interface.</p>
<p>Once this is done, you can commit all your changes and push them to
your repository remote.</p>
<p><strong>Important</strong>: before pushing, be sure that the
<code>_book</code> directory is not listed in your
<code>.gitignore</code> file !</p>
<p>Thereafter, you should be able to <a href="https://docs.gitlab.com/ee/ci/pipelines/#view-pipelines" class="external-link">see your
pipeline running</a> on Gitlab.</p>
</div>
<div class="section level5">
<h5 id="how-can-i-find-the-book-deployed-on-posit-connect">How can I find the book deployed on Posit Connect ?<a class="anchor" aria-label="anchor" href="#how-can-i-find-the-book-deployed-on-posit-connect"></a>
</h5>
<p>If your pipeline did not raise any error, you book is now deployed on
your Posit Connect. You can now log in your Posit Connect and enjoy your
app !</p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sébastien Rochette, Margot Brard, Murielle Delmotte, Swann Floc’hlay, Yohann Mansiaux.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
